# =============================================================================
# KEYCLOAK LOGIN THEME - CryptoJackpot
# =============================================================================
# Este ConfigMap contiene todos los recursos del tema de login personalizado.
# 
# ESTRUCTURA:
# - theme.properties: Configuración base del tema
# - login.css: Estilos CSS (basados en el frontend React)
# - messages_en.properties: Traducciones en inglés
# - messages_es.properties: Traducciones en español
# - *.ftl: Templates FreeMarker para cada página
#
# PARA MODIFICAR:
# - Colores: Buscar "CSS Variables" en login.css
# - Logo: Buscar "#kc-header-wrapper::before" en login.css
# - Textos: Modificar messages_*.properties
# - Estructura HTML: Modificar los archivos *.ftl
# =============================================================================

apiVersion: v1
kind: ConfigMap
metadata:
  name: keycloak-login-theme
  namespace: cryptojackpot
  labels:
    app: keycloak
    component: login-theme
data:
  # ===========================================================================
  # THEME PROPERTIES - Configuración base
  # ===========================================================================
  theme.properties: |
    parent=keycloak
    import=common/keycloak
    styles=css/login.css
    
  # ===========================================================================
  # CSS STYLES - Basado en el frontend React de CryptoJackpot
  # ===========================================================================
  login.css: |
    /* ===== CryptoJackpot Theme ===== */
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');
    
    /* ----- CSS Variables (Editar aquí los colores) ----- */
    :root {
      --body-font: 'Inter', sans-serif;
      --transition: all 0.5s ease-in-out;
      --p1: rgba(174, 254, 58, 1);      /* Primary green */
      --s1: rgba(85, 74, 255, 1);       /* Secondary purple */
      --act1: rgba(254, 68, 69, 1);     /* Error red */
      --act3: rgba(254, 201, 47, 1);    /* Warning yellow */
      --nw1: rgba(255, 255, 255, 1);
      --nw4: rgba(218, 218, 218, 1);
      --n0: #ffffff;
      --n2: rgba(26, 26, 26, 1);
      --n3: rgba(78, 78, 78, 1);
      --n4: rgba(0, 0, 0, 1);
    }

    /* ----- Global Styles ----- */
    html { scroll-behavior: smooth; }
    body {
      background-color: #000000 !important;
      font-family: var(--body-font) !important;
      font-size: 18px;
      line-height: 150%;
      min-height: 100vh;
      margin: 0 !important;
      padding: 0 !important;
    }
    a { text-decoration: none !important; color: var(--s1); transition: var(--transition); }
    a:hover { opacity: 0.8 !important; }
    h1, h2, h3, h4, h5, h6 { font-family: var(--body-font) !important; color: var(--n3) !important; font-weight: 800 !important; }

    /* ----- Hide Keycloak defaults ----- */
    .login-pf-page .login-pf-brand, #kc-locale, .login-pf-page .login-pf-footer, .pf-c-background-image { display: none !important; }

    /* ----- Page Container ----- */
    .login-pf-page { background-color: #000000 !important; min-height: 100vh !important; display: flex !important; align-items: center !important; justify-content: center !important; }
    .login-pf-page .card-pf { background-color: transparent !important; border: none !important; box-shadow: none !important; max-width: 400px !important; padding: 40px 15px !important; margin: 0 auto !important; }

    /* ----- Logo (Cambiar URL aquí) ----- */
    #kc-header-wrapper { font-size: 0 !important; text-align: center !important; margin-bottom: 40px !important; }
    #kc-header-wrapper::before { content: ''; display: block; width: 200px; height: 60px; margin: 0 auto 20px; background-image: url('https://your-cdn.com/logo.png'); background-size: contain; background-repeat: no-repeat; background-position: center; }
    #kc-header-wrapper::after { content: 'CriptoJackpot'; font-size: 28px !important; font-weight: 800 !important; color: var(--p1) !important; display: block; text-align: center; }

    /* ----- Page Title ----- */
    #kc-page-title { color: var(--n3) !important; font-size: 32px !important; font-weight: 700 !important; text-align: left !important; margin-bottom: 12px !important; }

    /* ----- Form Elements ----- */
    .login-pf-page .form-group { margin-bottom: 16px !important; }
    .login-pf-page label { color: var(--n3) !important; font-size: 14px !important; margin-bottom: 8px !important; display: block !important; }
    .login-pf-page input[type="text"], .login-pf-page input[type="password"], .login-pf-page input[type="email"] {
      color: white !important; background-color: #000000 !important; border: 1px solid var(--nw4) !important;
      border-radius: 12px !important; padding: 14px 18px !important; width: 100% !important;
      font-size: 16px !important; box-sizing: border-box !important; transition: var(--transition) !important;
    }
    .login-pf-page input::placeholder { color: rgba(255, 255, 255, 0.5) !important; }
    .login-pf-page input:focus { border-color: var(--s1) !important; outline: none !important; }

    /* ----- Buttons ----- */
    .login-pf-page .btn-primary, .login-pf-page #kc-login, .login-pf-page input[type="submit"] {
      display: inline-flex !important; align-items: center !important; justify-content: center !important;
      padding: 16px 24px !important; font-weight: 600 !important; border-radius: 12px !important;
      border: none !important; width: 100% !important; font-size: 16px !important;
      background: var(--s1) !important; color: var(--n0) !important; cursor: pointer !important; margin-top: 16px !important;
    }
    .login-pf-page .btn-primary:hover, .login-pf-page #kc-login:hover, .login-pf-page input[type="submit"]:hover { background: #4a3fd4 !important; }
    .login-pf-page .btn-default { background: transparent !important; border: 1px solid var(--nw4) !important; border-radius: 12px !important; color: var(--n3) !important; padding: 12px 20px !important; }

    /* ----- Links ----- */
    #kc-form-options { text-align: right !important; margin-bottom: 16px !important; }
    #kc-form-options a { color: var(--s1) !important; font-size: 14px !important; }
    #kc-registration { text-align: left !important; margin-bottom: 40px !important; }
    #kc-registration span { color: var(--n3) !important; }
    #kc-registration a { color: var(--s1) !important; font-weight: 600 !important; }

    /* ----- Alerts ----- */
    .login-pf-page .alert { padding: 12px 16px !important; border-radius: 8px !important; margin-bottom: 16px !important; font-size: 14px !important; }
    .login-pf-page .alert-error { background-color: rgba(254, 68, 69, 0.1) !important; border: 1px solid var(--act1) !important; color: var(--act1) !important; }
    .login-pf-page .alert-success { background-color: rgba(174, 254, 58, 0.1) !important; border: 1px solid var(--p1) !important; color: #155724 !important; }
    .login-pf-page .alert-warning { background-color: rgba(254, 201, 47, 0.1) !important; border: 1px solid var(--act3) !important; color: #856404 !important; }
    .login-pf-page .alert-info { background-color: rgba(85, 74, 255, 0.1) !important; border: 1px solid var(--s1) !important; color: var(--s1) !important; }
    .pf-c-form__helper-text.pf-m-error { color: var(--act1) !important; font-size: 12px !important; margin-top: 4px !important; }

    /* ----- Checkbox ----- */
    .login-pf-page input[type="checkbox"] { accent-color: var(--s1) !important; width: 18px !important; height: 18px !important; }

    /* ----- Social Login ----- */
    #kc-social-providers { margin-top: 24px !important; }
    #kc-social_providers h4 { color: var(--n3) !important; text-align: center !important; font-size: 14px !important; margin-bottom: 16px !important; }
    #kc-social_providers a { background: transparent !important; border: 1px solid var(--nw4) !important; border-radius: 12px !important; color: var(--n3) !important; padding: 12px 20px !important; display: flex !important; justify-content: center !important; margin-bottom: 10px !important; }
    #kc-social_providers a:hover { border-color: var(--s1) !important; color: var(--s1) !important; }

    /* ----- Responsive ----- */
    @media (max-width: 480px) { .login-pf-page .card-pf { padding: 20px 15px !important; } #kc-page-title, #kc-header-wrapper::after { font-size: 24px !important; } }

  # ===========================================================================
  # MESSAGES - English
  # ===========================================================================
  messages_en.properties: |
    loginTitle=Sign In
    doLogIn=Sign In
    usernameOrEmail=Email
    passwordLabel=Password
    rememberMe=Remember me
    noAccount=New user?
    doRegister=Create Account
    doForgotPassword=Forgot your password?
    registerTitle=Create Account
    loginLinkTitle=Already have an account?
    emailLabel=Email
    firstNameLabel=First Name
    lastNameLabel=Last Name
    passwordConfirmLabel=Confirm Password
    emailForgotTitle=Reset Password
    emailInstruction=Enter your email and we'll send you a link to reset your password.
    backToLogin=Back to Sign In
    updatePasswordTitle=Create New Password
    passwordNew=New Password
    passwordNewConfirm=Confirm New Password
    emailVerifyTitle=Verify Your Email
    emailVerifyInstruction=An email with verification instructions has been sent to your email address.
    doClickHere=Click here to resend
    doSubmit=Submit
    doCancel=Cancel
    invalidUserMessage=Invalid email or password
    identity-provider-login-label=Or continue with

  # ===========================================================================
  # MESSAGES - Spanish
  # ===========================================================================
  messages_es.properties: |
    loginTitle=Iniciar Sesión
    doLogIn=Iniciar Sesión
    usernameOrEmail=Email
    passwordLabel=Contraseña
    rememberMe=Recordarme
    noAccount=¿Nuevo usuario?
    doRegister=Crear Cuenta
    doForgotPassword=¿Olvidaste tu contraseña?
    registerTitle=Crear Cuenta
    loginLinkTitle=¿Ya tienes cuenta?
    emailLabel=Correo Electrónico
    firstNameLabel=Nombre
    lastNameLabel=Apellido
    passwordConfirmLabel=Confirmar Contraseña
    emailForgotTitle=Restablecer Contraseña
    emailInstruction=Ingresa tu correo y te enviaremos un enlace para restablecer tu contraseña.
    backToLogin=Volver a Iniciar Sesión
    updatePasswordTitle=Crear Nueva Contraseña
    passwordNew=Nueva Contraseña
    passwordNewConfirm=Confirmar Nueva Contraseña
    emailVerifyTitle=Verifica tu Correo
    emailVerifyInstruction=Se ha enviado un correo con instrucciones de verificación.
    doClickHere=Haz clic aquí para reenviar
    doSubmit=Enviar
    doCancel=Cancelar
    invalidUserMessage=Correo o contraseña inválidos
    identity-provider-login-label=O continuar con

  # ===========================================================================
  # TEMPLATE - Login
  # ===========================================================================
  login.ftl: |
    <#import "template.ftl" as layout>
    <@layout.registrationLayout displayMessage=!messagesPerField.existsError('username','password') displayInfo=realm.password && realm.registrationAllowed && !registrationDisabled??; section>
        <#if section = "header">${msg("loginTitle")}
        <#elseif section = "form">
            <div id="kc-form"><div id="kc-form-wrapper">
                <#if realm.password && realm.registrationAllowed && !registrationDisabled??>
                    <div id="kc-registration"><span>${msg("noAccount")} <a href="${url.registrationUrl}">${msg("doRegister")}</a></span></div>
                </#if>
                <#if realm.password>
                    <form id="kc-form-login" action="${url.loginAction}" method="post">
                        <div class="form-group">
                            <label for="username">${msg("usernameOrEmail")}</label>
                            <input id="username" name="username" value="${(login.username!'')}" type="text" autofocus placeholder="${msg("usernameOrEmail")}"/>
                            <#if messagesPerField.existsError('username','password')><span class="pf-c-form__helper-text pf-m-error">${kcSanitize(messagesPerField.getFirstError('username','password'))?no_esc}</span></#if>
                        </div>
                        <div class="form-group">
                            <label for="password">${msg("passwordLabel")}</label>
                            <input id="password" name="password" type="password" placeholder="${msg("passwordLabel")}"/>
                        </div>
                        <#if realm.resetPasswordAllowed><div id="kc-form-options"><a href="${url.loginResetCredentialsUrl}">${msg("doForgotPassword")}</a></div></#if>
                        <#if realm.rememberMe && !usernameHidden??>
                            <div class="form-group" style="margin-top:16px"><label style="display:flex;align-items:center;gap:8px;cursor:pointer">
                                <input id="rememberMe" name="rememberMe" type="checkbox" <#if login.rememberMe??>checked</#if>>${msg("rememberMe")}
                            </label></div>
                        </#if>
                        <div id="kc-form-buttons"><input type="hidden" name="credentialId" <#if auth.selectedCredential?has_content>value="${auth.selectedCredential}"</#if>/><input id="kc-login" type="submit" value="${msg("doLogIn")}"/></div>
                    </form>
                </#if>
            </div></div>
        <#elseif section = "socialProviders">
            <#if realm.password && social.providers??><div id="kc-social-providers"><h4>${msg("identity-provider-login-label")}</h4>
                <#list social.providers as p><a href="${p.loginUrl}">${p.displayName!}</a></#list>
            </div></#if>
        </#if>
    </@layout.registrationLayout>

  # ===========================================================================
  # TEMPLATE - Register
  # ===========================================================================
  register.ftl: |
    <#import "template.ftl" as layout>
    <@layout.registrationLayout displayMessage=!messagesPerField.existsError('firstName','lastName','email','password','password-confirm'); section>
        <#if section = "header">${msg("registerTitle")}
        <#elseif section = "form">
            <div style="margin-bottom:40px"><span style="color:var(--n3)">${msg("loginLinkTitle")} <a href="${url.loginUrl}" style="color:var(--s1);font-weight:600">${msg("doLogIn")}</a></span></div>
            <form id="kc-register-form" action="${url.registrationAction}" method="post">
                <div class="form-group"><label>${msg("firstNameLabel")} *</label><input id="firstName" name="firstName" value="${(register.formData.firstName!'')}" placeholder="${msg("firstNameLabel")}"/><#if messagesPerField.existsError('firstName')><span class="pf-c-form__helper-text pf-m-error">${kcSanitize(messagesPerField.get('firstName'))?no_esc}</span></#if></div>
                <div class="form-group"><label>${msg("lastNameLabel")} *</label><input id="lastName" name="lastName" value="${(register.formData.lastName!'')}" placeholder="${msg("lastNameLabel")}"/><#if messagesPerField.existsError('lastName')><span class="pf-c-form__helper-text pf-m-error">${kcSanitize(messagesPerField.get('lastName'))?no_esc}</span></#if></div>
                <div class="form-group"><label>${msg("emailLabel")} *</label><input type="email" id="email" name="email" value="${(register.formData.email!'')}" placeholder="${msg("emailLabel")}"/><#if messagesPerField.existsError('email')><span class="pf-c-form__helper-text pf-m-error">${kcSanitize(messagesPerField.get('email'))?no_esc}</span></#if></div>
                <div class="form-group"><label>${msg("passwordLabel")} *</label><input type="password" id="password" name="password" placeholder="${msg("passwordLabel")}"/><#if messagesPerField.existsError('password')><span class="pf-c-form__helper-text pf-m-error">${kcSanitize(messagesPerField.get('password'))?no_esc}</span></#if></div>
                <div class="form-group"><label>${msg("passwordConfirmLabel")} *</label><input type="password" id="password-confirm" name="password-confirm" placeholder="${msg("passwordConfirmLabel")}"/><#if messagesPerField.existsError('password-confirm')><span class="pf-c-form__helper-text pf-m-error">${kcSanitize(messagesPerField.get('password-confirm'))?no_esc}</span></#if></div>
                <div id="kc-form-buttons"><input type="submit" value="${msg("doRegister")}"/></div>
            </form>
        </#if>
    </@layout.registrationLayout>

  # ===========================================================================
  # TEMPLATE - Reset Password
  # ===========================================================================
  login-reset-password.ftl: |
    <#import "template.ftl" as layout>
    <@layout.registrationLayout displayInfo=true displayMessage=!messagesPerField.existsError('username'); section>
        <#if section = "header">${msg("emailForgotTitle")}
        <#elseif section = "form">
            <form action="${url.loginAction}" method="post">
                <p style="color:var(--n3);font-size:14px;margin-bottom:24px">${msg("emailInstruction")}</p>
                <div class="form-group"><label>${msg("emailLabel")}</label><input type="email" id="username" name="username" autofocus placeholder="${msg("emailLabel")}" value="${(auth.attemptedUsername!'')}"/><#if messagesPerField.existsError('username')><span class="pf-c-form__helper-text pf-m-error">${kcSanitize(messagesPerField.getFirstError('username'))?no_esc}</span></#if></div>
                <div id="kc-form-buttons"><input type="submit" value="${msg("doSubmit")}"/></div>
                <div style="text-align:center;margin-top:16px"><a href="${url.loginUrl}">${msg("backToLogin")}</a></div>
            </form>
        </#if>
    </@layout.registrationLayout>

  # ===========================================================================
  # TEMPLATE - Update Password
  # ===========================================================================
  login-update-password.ftl: |
    <#import "template.ftl" as layout>
    <@layout.registrationLayout displayMessage=!messagesPerField.existsError('password','password-confirm'); section>
        <#if section = "header">${msg("updatePasswordTitle")}
        <#elseif section = "form">
            <form action="${url.loginAction}" method="post">
                <input type="hidden" name="username" value="${username}"/>
                <div class="form-group"><label>${msg("passwordNew")} *</label><input type="password" id="password-new" name="password-new" autofocus placeholder="${msg("passwordNew")}"/><#if messagesPerField.existsError('password')><span class="pf-c-form__helper-text pf-m-error">${kcSanitize(messagesPerField.get('password'))?no_esc}</span></#if></div>
                <div class="form-group"><label>${msg("passwordNewConfirm")} *</label><input type="password" id="password-confirm" name="password-confirm" placeholder="${msg("passwordNewConfirm")}"/><#if messagesPerField.existsError('password-confirm')><span class="pf-c-form__helper-text pf-m-error">${kcSanitize(messagesPerField.get('password-confirm'))?no_esc}</span></#if></div>
                <div id="kc-form-buttons"><input type="submit" value="${msg("doSubmit")}"/><#if isAppInitiatedAction??><button class="btn-default" type="submit" name="cancel-aia" value="true" style="margin-top:10px">${msg("doCancel")}</button></#if></div>
            </form>
        </#if>
    </@layout.registrationLayout>

  # ===========================================================================
  # TEMPLATE - Verify Email
  # ===========================================================================
  login-verify-email.ftl: |
    <#import "template.ftl" as layout>
    <@layout.registrationLayout displayInfo=true; section>
        <#if section = "header">${msg("emailVerifyTitle")}
        <#elseif section = "form">
            <div style="text-align:center;padding:40px 0">
                <div style="width:80px;height:80px;margin:0 auto 24px;background:rgba(85,74,255,0.1);border-radius:50%;display:flex;align-items:center;justify-content:center">
                    <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="rgba(85,74,255,1)" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
                </div>
                <p style="color:var(--n3);font-size:16px;line-height:1.6;margin-bottom:24px">${msg("emailVerifyInstruction")}</p>
                <a href="${url.loginAction}" style="color:var(--s1);font-weight:600">${msg("doClickHere")}</a>
            </div>
        </#if>
    </@layout.registrationLayout>
